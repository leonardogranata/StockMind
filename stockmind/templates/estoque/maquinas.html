{% extends "base.html" %}
{% load static %}

{% block title %}StockMind - M√°quinas{% endblock title %}

{% block content %}
<div class="container-listagem">
    <div class="secao-topo">
        <div class="conteudo-topo">
            <h1 class="titulo-pagina">M√°quinas</h1>
            <p class="subtitulo-pagina">Gerencie todas as m√°quinas do sistema</p>
        </div>
        <div class="botoes">
            <button id="create-item-button" onclick="window.location.href='{% url 'cadastro_maquina' %}'">
                <img src="{% static "media/img/new-icon.png" %}" alt="Icone de novo">
                Novo  
            </button>
        </div>
    </div>

    {% if maquinas %}
        <div class="grade-cards">
            {% for maquina in maquinas %}
                <div class="card-maquina">
                    <div class="cabecalho-card">
                        <div class="codigo-card">{{ maquina.codigo }}</div>
                        <div class="badge-status status-{{ maquina.status|lower|cut:' ' }}">
                            {% if maquina.status == "Ativa" %}
                                ‚úì Ativa
                            {% elif maquina.status == "Em manuten√ß√£o" %}
                                ‚öô Manuten√ß√£o
                            {% else %}
                                ‚úï Inativa
                            {% endif %}
                        </div>
                    </div>

                    <div class="corpo-card">
                        <h3 class="titulo-card">{{ maquina.nome }}</h3>
                        
                        {% if maquina.descricao %}
                        <p class="descricao-card">{{ maquina.descricao|truncatewords:15 }}</p>
                        {% endif %}

                        <div class="informacoes-card">
                            {% if maquina.localizacao %}
                            <div class="item-info">
                                <span class="icone-info">üìç</span>
                                <span class="texto-info">{{ maquina.localizacao }}</span>
                            </div>
                            {% endif %}

                            {% if maquina.data_aquisicao %}
                            <div class="item-info">
                                <span class="icone-info">üìÖ</span>
                                <span class="texto-info">{{ maquina.data_aquisicao|date:"d/m/Y" }}</span>
                            </div>
                            {% endif %}

                            {% if maquina.pecas.count > 0 %}
                            <div class="item-info">
                                <span class="icone-info">üîß</span>
                                <span class="texto-info">{{ maquina.pecas.count }} pe√ßa{{ maquina.pecas.count|pluralize:"s" }}</span>
                            </div>
                            {% endif %}
                        </div>
                    </div>

                    <div class="acoes-card">
                        <a href="{% url 'editar_maquina' maquina.id %}" class="botao-acao botao-editar">
                            Editar
                        </a>
                        <a href="{% url 'excluir_maquina' maquina.id %}" class="botao-acao botao-deletar">  
                            Deletar
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
    <div class="estado-vazio">
        <div class="icone-vazio">üè≠</div>
        <h2 class="titulo-vazio">Nenhuma m√°quina cadastrada</h2>
        <p class="texto-vazio">Comece adicionando sua primeira m√°quina ao sistema</p>
        <a href="{% url 'cadastro_maquina' %}" class="botao-vazio">
            + Cadastrar primeira m√°quina
        </a>
    </div>
    {% endif %}
</div>
{% endblock content %}